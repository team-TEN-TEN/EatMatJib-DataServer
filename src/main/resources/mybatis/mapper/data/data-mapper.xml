<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tenten.eatmatjib.data.pipeline.datamapper.DataMapper">
  <insert id="initData" parameterType="com.tenten.eatmatjib.data.pipeline.dto.Data">
    INSERT
    INTO raw_restaurant
    (opnsfteamcode,
     mgtno,
     apvpermymd,
     apvcancelymd,
     trdstategbn,
     trdstatenm,
     dtlstategbn,
     dtlstatenm,
     dcbymd,
     clgstdt,
     clgenddt,
     ropnymd,
     sitetel,
     sitearea,
     sitepostno,
     sitewhladdr,
     rdnwhladdr,
     rdnpostno,
     bplcnm,
     lastmodts,
     updategbn,
     updatedt,
     uptaenm,
     x,
     y,
     sntuptaenm,
     maneipcnt,
     wmeipcnt,
     trdpjubnsenm,
     lvsenm,
     wtrsplyfacilsenm,
     totepnum,
     hoffepcnt,
     fctyowkepcnt,
     fctysiljobepcnt,
     fctypdtjobepcnt,
     bdngownsenm,
     isream,
     monam,
     multusnupsoyn,
     faciltotscp,
     jtupsoasgnno,
     jtupsomainedf,
     homepage,
     is_updated)
    VALUES (#{opnsfteamcode},
            #{mgtno},
            #{apvpermymd},
            #{apvcancelymd},
            #{trdstategbn},
            #{trdstatenm},
            #{dtlstategbn},
            #{dtlstatenm},
            #{dcbymd},
            #{clgstdt},
            #{clgenddt},
            #{ropnymd},
            #{sitetel},
            #{sitearea},
            #{sitepostno},
            #{sitewhladdr},
            #{rdnwhladdr},
            #{rdnpostno},
            #{bplcnm},
            #{lastmodts},
            #{updategbn},
            #{updatedt},
            #{uptaenm},
            #{x},
            #{y},
            #{sntuptaenm},
            #{maneipcnt},
            #{wmeipcnt},
            #{trdpjubnsenm},
            #{lvsenm},
            #{wtrsplyfacilsenm},
            #{totepnum},
            #{hoffepcnt},
            #{fctyowkepcnt},
            #{fctysiljobepcnt},
            #{fctypdtjobepcnt},
            #{bdngownsenm},
            #{isream},
            #{monam},
            #{multusnupsoyn},
            #{faciltotscp},
            #{jtupsoasgnno},
            #{jtupsomainedf},
            #{homepage},
            1)

  </insert>

  <select id="selectRawData" resultType="com.tenten.eatmatjib.data.pipeline.dto.Data">
    SELECT * FROM RAW_RESTAURANT WHERE IS_UPDATED = 1;
  </select>

  <update id="changedColumns">
    UPDATE RAW_RESTAURANT
    SET is_updated = 0
    WHERE is_updated = 1;
  </update>


</mapper>